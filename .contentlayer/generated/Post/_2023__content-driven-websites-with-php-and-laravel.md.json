{
  "title": "Content-driven websites with PHP and Laravel",
  "description": "It's PHPin' time!",
  "pubDate": "2023-12-13T08:00:00.000Z",
  "category": "laravel",
  "heroImage": "/images/migrating-to-laravel/meme.jpg",
  "draft": false,
  "keywords": [
    "php",
    "laravel"
  ],
  "body": {
    "raw": "\nAlright, I'm making this one short (sort of). My pre-New Year's Resolution is to write on my blog here more\nthan bi-annually. Since becoming a dad and taking up my jorts-laden mantle and becoming alarmingly interested in grass\nmowing techniques and New Balance footwear this past year, finding the time to write has come too far and between\n(betwixt?).\n\nI was recently on the hunt for something new to learn and after laughing at memes\non [r/webdev](https://reddit.com/r/webdev/) about PHP for far too long, I figured I had better at least learn a little\nPHP\nto understand the source of the meme'ery in the first place. Learning PHP ultimately brought me\nto [Laravel](https://laravel.com/),\nand oh... my... god... do I feel betrayed by my fellow developers for dunking on PHP without telling me about the\nabundant Lambos running rampant in the Laravel ecosystem. I've been writing a bunch of Rust to keep my brain occupied\noutside my normal 8-to-5 and PHP was a breath of fresh air.\n\nIf you're a full-time TypeScript/.NET'er working with a sprinkle of other languages like Go and Rust here and there like\nme, PHP might seem like an afterthought. I can confidently say that after embarking down the Laravel/PHP road, I'm more\nthan happy I did.\n\nI thought it would be fun to write a bit about the process of learning Laravel through re-writing my website from a few\ndifferent iterations of JS frameworks and give some insight from a newcomers perspective about Laravel and PHP.\n\n## Framework exhaustion\n\nI'm a creature of habit, and one thing I've formed somewhat of a ritual around is re-writing my website, the very one\nyou happen to be reading, at least once a year. I've gone through a few iterations:\n\n- Static site generators with Hugo and Jekyll\n- SSR frameworks\n  with [Next.js](https://github.com/JoeyMckenzie/joeymckenzie.tech/tree/archive/blog-v1), [Nuxt.js](https://github.com/JoeyMckenzie/joeymckenzie.tech/tree/archive/nuxt-v2),\n  and [SvelteKit](https://github.com/JoeyMckenzie/joeymckenzie.tech/tree/archive/svelte)\n- At one point, a combo of [Astro and Rust](https://github.com/JoeyMckenzie/joeymckenzie.tech/tree/archive/astro-rust)\n  that formed an interesting mix of SSG and [island architectures](https://docs.astro.build/en/concepts/islands/) for\n  fetching dynamic data\n\nQuite frankly, I'm burnt out on JS framework madness, though to no fault of their own. There's many that are innovating\nand pushing the ecosystem forward with cool new technology that I'll get to use in production five years from now if I'm\nlucky. Each iteration I re-wrote wrangled a hodge podge of JS libraries for certain things I wanted to do, including but\nnot limited to:\n\n- Parsing markdown\n  content ([contentlayer](https://contentlayer.dev), [gray-matter](https://www.npmjs.com/package/gray-matter)) and\n  highlighting code snippets ([highlight.js](https://highlightjs.org/), [shiki](https://shiki.matsu.io/))\n- Storing things in a database with a bit of magic\n  abstraction ([prisma](https://prisma.io), [drizzle](https://orm.drizzle.team/))\n- Calling external APIs through framework semantics, which differ from framework to framework\n- Caching content pages as I don't update them often\n\nAnd a plethora of other things. The nice thing about Laravel is that a lot of this is out-of-the-box functionality so\nI can indulge in my slice-of-the-internet playground that is my website.\n\n## Making code great again\n\nI found that while re-building my site with Laravel, I was having fun writing code in a new way that I was missing when\nusing the JS flavor of the month framework. My .NET brain felt right at home with Laravel, all the while being able to\nmix and match frontends thanks to [Inertia.js](https://inertiajs.com) (I'm not quite ready to\nembrace [Livewire](https://livewire.laravel.com/) just yet). Anything I wanted to do, Laravel had an answer:\n\n- Syncing content to the database on\n  deployment? [Console commands](https://laravel.com/docs/10.x/artisan#generating-commands).\n- Querying content? [Eloquent](https://laravel.com/docs/10.x/eloquent).\n- Built-in caching, an HTTP client, and just about anything you'll need for the general web\n\nThe goal of this post will be to outline what I think makes Laravel great from the context of a PHP/Laravel outsider\neven for a small, mostly static website like mine.\n\n## DI from the start\n\nComing from .NET, I clutch onto my DI framework pearls tightly, rarely loosening my grip. I'll even die on the hill that\n.NET's first-party dependency injection framework (when used within it's expected confines) is one of the better DI\nframeworks out there (I've enjoyed it _much_ more than Spring's DI with magical `@autowire`s on every bean).\n\nI like to _think_ I'm not that much of a DI container shill after writing a few things in Rust and Go, and while they\nhave there place and time when serving a viable purpose, are nice to work with _when used correctly_. I see a lot of\n.NET in the wild attempting to bend `ServiceProvider`s to their application's will, creating a poor man's service\nlocator within a service locator (I'm guilty as charged).\n\nWith Laravel, binding contracts to concretes is simple and straight forward. Coupled with route-provider binding\nbuilt-in DI, it quite literally felt like I was back at home writing a modern .NET application.\n\n## Strict linting opt-in\n\nI'm glutton for punishment and Rust-level strict typing, so [phpstan](https://phpstan.org/) with the\nhelp [larastan](https://github.com/larastan/larastan) cranked up to the max scratched that itch. I'm currently\nin the process of trimming down the things I don't need with Laravel, which ultimately entails things\nlike removing auth-based middleware, migrations, and models since I have no intention of managing users. While max level\nphpstan requires a few tweaks to a freshly scaffolded [Laravel Breeze](https://github.com/laravel/breeze) app, once\nthose tweaks were made that mainly consisted of a few typing hints here and there, everything worked as expected.\nCoupled with [fswatch](https://github.com/emcrisostomo/fswatch), I got the same DX as I'm used to with Rust akin to\nrunning something like `cargo watch -x clippy` with the help of [cargo-watch](https://crates.io/crates/cargo-watch).\nBetter yet, hiding said `fswatch` command behind a [justfile](https://github.com/casey/just) made it seamless to\nintegrate phpstan continuously while I was writing code:\n\n```shell\ndefault: pail\n\n# runs tail logging\npail:\n    php artisan pail\n\n# syncs content to the database\nsync:\n    php artisan app:sync-content\n\n# continuously runs lint on file change\nlint:\n    fswatch -o app/ | xargs -n1 -I{} sh -c \"composer run lint\"\n```\n\nand in my terminal:\n\n```shell\n$ just lint # which runs `fswatch -o app/ | xargs -n1 -I{} sh -c \"composer run lint\"` by proxy\n\n> vendor/bin/phpstan analyse app\n\n\nNote: Using configuration file /Users/jmckenzie/projects/php/joeymckenzie.tech/phpstan.neon.\n 40/40 [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100%\n\n\n [OK] No errors\n```\n\nBeautiful! Any source code change within my `app/` directory triggered a full linting run to make sure I was holding\nmyself accountable for not letting my code go to shit (pardon my French).\n\nSide note, composer is easily up there with cargo competing for best language toolchain on the market. I mean come on\nJavaScript... why do we need four different package managers?\n\n## Content syncing\n\nOne of the things I need is the ability to continuously sync markdown content with the database I store it in, which in\nmy case is just a MySQL instance running on my droplet provisioned with the help of Laravel Forge (more on that later).\nRather than writing some one off shell script to do that, I found Laravel commands mighty useful to simply just define a\ncustom artisan command that would:\n\n- Read my content files\n- Parse the frontmatter on each markdown file\n- Parse the markdown and convert it to HTML\n- Save everything to the data to the database\n\nThat ended up looking something like:\n\n```php\n<?php\n\ndeclare(strict_types=1);\n\nnamespace App\\Console\\Commands;\n\nuse App\\Contracts\\ContentUtilityContract;\nuse App\\Models\\ContentMeta;\nuse Illuminate\\Console\\Command;\nuse Throwable;\n\nfinal class SyncContent extends Command\n{\n    /**\n     * The name and signature of the console command.\n     *\n     * @var string\n     */\n    protected $signature = 'app:sync-content';\n\n    /**\n     * The console command description.\n     *\n     * @var string\n     */\n    protected $description = 'Syncs content from markdown files into the database.';\n\n    /**\n     * Execute the console command.\n     *\n     * @throws Throwable\n     */\n    public function handle(ContentUtilityContract $contentUtility): void\n    {\n        $files = $contentUtility->getMarkdownFilePaths();\n        collect($files)\n            ->map(fn (string $filePath) => $contentUtility->getParsedContent($filePath))\n            ->each(fn (ContentMeta $contentMeta) => $contentUtility->upsertBlogPost($contentMeta));\n    }\n}\n```\n\nComing from .NET, I'm a self diagnosed [LINQ](https://learn.microsoft.com/en-us/dotnet/csharp/linq/) addict. Collections\nmade me feel right at home. From the above, I'm configuring a short pipeline of sorts that will do all the things I\noutlined with a little help from the DI container and the `ContentUtilityContract`:\n\n```php\n<?php\n\ndeclare(strict_types=1);\n\nnamespace App\\Contracts;\n\nuse App\\Models\\BlogPost;\nuse App\\Models\\ContentMeta;\nuse League\\CommonMark\\Exception\\CommonMarkException;\nuse League\\Config\\Exception\\ConfigurationExceptionInterface;\n\ninterface ContentUtilityContract\n{\n    /**\n     * @return string[]\n     */\n    public function getMarkdownFilePaths(): array;\n\n    /**\n     * @throws ConfigurationExceptionInterface\n     * @throws CommonMarkException\n     */\n    public function getParsedContent(string $filePath): ContentMeta;\n\n    public function upsertBlogPost(ContentMeta $contentMeta): BlogPost;\n}\n```\n\nand whose implementation looks something like:\n\n```php\n<?php\n\ndeclare(strict_types=1);\n\nnamespace App\\Services;\n\nuse App\\Contracts\\ContentUtilityContract;\nuse App\\Models\\BlogPost;\nuse App\\Models\\ContentMeta;\nuse Illuminate\\Support\\Facades\\Log;\nuse League\\CommonMark\\ConverterInterface;\nuse League\\CommonMark\\Extension\\FrontMatter\\Data\\SymfonyYamlFrontMatterParser;\nuse League\\CommonMark\\Extension\\FrontMatter\\FrontMatterParser;\nuse Override;\n\nfinal readonly class MarkdownUtility implements ContentUtilityContract\n{\n    private ConverterInterface $converter;\n\n    public function __construct(ConverterInterface $converter)\n    {\n        $this->converter = $converter;\n    }\n\n    #[Override]\n    public function getMarkdownFilePaths(): array\n    {\n        $basePath = base_path();\n        $contentPath = \"$basePath\".'/content';\n\n        Log::info(\"identified content path as $contentPath, globbing content files\");\n\n        /** @var string[] $files */\n        $files = app()->environment() === 'local'\n            ? glob(\"$contentPath/**/*.md\", GLOB_BRACE)\n            : glob(\"$contentPath/*[!draft]/*.md\", GLOB_BRACE);\n\n        $fileCount = count($files);\n\n        Log::info(\"$fileCount globbed files found\");\n\n        return $files;\n    }\n\n    #[Override]\n    public function getParsedContent(string $filePath): ContentMeta\n    {\n        Log::info(\"parsing content for file $filePath\");\n\n        /** @var string $contents */\n        $contents = file_get_contents($filePath);\n        $fileInfo = pathinfo($filePath);\n        $extension = empty($fileInfo['extension'])\n            ? ''\n            : '.'.$fileInfo['extension'];\n        $fileSlug = basename($filePath, $extension);\n\n        Log::info(\"file parsed, determined slug as $fileSlug\");\n\n        $frontMatterParser = new FrontMatterParser(new SymfonyYamlFrontMatterParser());\n        $parsedContent = $frontMatterParser->parse($contents);\n        $frontMatter = $parsedContent->getFrontMatter();\n        $markdown = $parsedContent->getContent();\n        $html = $this->converter->convert($markdown)->getContent();\n\n        Log::info('frontmatter and content parsed');\n\n        return new ContentMeta($fileSlug, $markdown, $html, $frontMatter);\n    }\n\n    #[Override]\n    public function upsertBlogPost(ContentMeta $contentMeta): BlogPost\n    {\n        $contentSlug = $contentMeta->slug;\n\n        Log::info(\"upserting blog post $contentSlug\");\n\n        $upsertedBlog = BlogPost::updateOrCreate([\n            'slug' => $contentSlug,\n        ], [\n            'slug' => $contentSlug,\n            'title' => $contentMeta->frontMatter->title,\n            'description' => $contentMeta->frontMatter->description,\n            'category' => $contentMeta->frontMatter->category,\n            'published_date' => $contentMeta->frontMatter->pubDate,\n            'hero_image' => $contentMeta->frontMatter->heroImage,\n            'keywords' => implode(',', $contentMeta->frontMatter->keywords),\n            'raw_content' => $contentMeta->markdown,\n            'parsed_content' => $contentMeta->html,\n        ]);\n\n        Log::info('blog content updated!');\n\n        return $upsertedBlog;\n    }\n}\n```\n\nNow from what I've gathered... folks in the PHP community don't exactly _love_ `final` classes - I have no intention on\ninheriting from these classes and like to follow a composition approach as often as possible (though not always).\n\nNow anytime I want to sync my content, a simple\n\n```shell\n$ artisan app:sync-content\n```\n\ndoes the trick! Note: I'm a lazy developer, so my `~/.zshrc` configuration has an alias:\n\n```shell\nalias artisan=\"php artisan\"\n```\n\nI could probably be even lazier and shorten it, but that'll do for now.\n\n## Servers\n\nUsing [Laravel Forge](https://forge.laravel.com/) and a DigitalOcean droplet, I'm able to turn the server provisioning\npart of my brain completely off and simply write code, commit, and push. Forge does just about everything for you when\ndeploying application servers, including setting up MySQL, PHP versions, server tooling, SSL, etc. I was even able to\ntweak the deployment script, so I could refresh/sync my markdown content with the database anytime a new deployment was\ntriggered. You're probably thinking \"wait... why do you have a database in the first place?\" There's a few reasons for\nthat.\n\nI use [torchlight](https://torchlight.dev/) for syntax highlighting in content, and storing the parsed content in the\ndatabase means I only need to pay the price of content highlighting once at deployment time. I also like to keep track\nof views on each blog, so I need some form of persistent storage. I _also_ like to keep my notes in there (one of my few\npieces of website flair) where I can simply SSH to my droplet and _drop_ (no pun intended) into\na [tinker](https://laravel.com/docs/10.x/artisan#tinker) session to create more notes, so something like this just works\nwhen I\nwant to add a new note without a GUI component:\n\n```shell\n# On the droplet...\n\nroot@website /home/forge/joeymckenzie.tech $ php artisan tinker\n\nPsy Shell v0.11.22 (PHP 8.3.0 — cli) by Justin Hileman\n\n> \\App\\Models\\Note::create(['title' => 'Networking', 'description' => 'I have no clue how SSL truly works.']);\n= App\\Models\\Note {#7285\n    title: \"Networking\",\n    description: \"I have no clue how SSL truly works.\",\n    +updated_at: \"2023-12-11 23:04:02\",\n    +created_at: \"2023-12-11 23:04:02\",\n    +id: 5,\n  }\n```\n\nI can also generate sitemaps on startup too which is \"dumb easy\" (as the kids say) with the help of\nSpatie's [Laravel sitemap library](https://github.com/spatie/laravel-sitemap) paired with another console command:\n\n```php\n<?php\n\ndeclare(strict_types=1);\n\nnamespace App\\Console\\Commands;\n\nuse App\\Models\\BlogPost;\nuse Illuminate\\Console\\Command;\nuse Spatie\\Sitemap\\SitemapGenerator;\nuse Spatie\\Sitemap\\Tags\\Url;\n\nclass GenerateSitemap extends Command\n{\n    /**\n     * The name and signature of the console command.\n     *\n     * @var string\n     */\n    protected $signature = 'app:generate-sitemap';\n\n    /**\n     * The console command description.\n     *\n     * @var string\n     */\n    protected $description = 'Generates the sitemap.';\n\n    /**\n     * Generates a sitemap for all the SEO goodness\n     */\n    public function handle(): void\n    {\n        /** @var string $url */\n        $url = config('app.url');\n\n        // Build the sitemap key that will ultimately live in the public directory\n        $publicPath = public_path();\n        $outputFile = \"$publicPath/sitemap-index.xml\";\n\n        // Grab a list of the slugs from the database so we can\n        // dynamically generate the different entries of the map\n        $slugs = BlogPost::select(['slug', 'updated_at'])->get();\n        $siteMap = SitemapGenerator::create($url)->getSitemap();\n\n        // Roll through each entry, mapping each to a sitemap entry with a low priority change value\n        collect($slugs)\n            ->each(function (BlogPost $blogPost) use ($siteMap) {\n                $slug = $blogPost->slug;\n                $siteMap\n                    ->add(Url::create(\"/blog/$slug\")\n                        ->setPriority(0.5)\n                        ->setChangeFrequency(Url::CHANGE_FREQUENCY_YEARLY)\n                        ->setLastModificationDate($blogPost->updated_at?->toDate() ?? now()));\n            });\n\n        // Finally, add the static pages as well\n        $siteMap\n            ->add(Url::create('/about')\n                ->setPriority(0.5)\n                ->setChangeFrequency(Url::CHANGE_FREQUENCY_YEARLY))\n            ->add(Url::create('/now')\n                ->setPriority(0.5)\n                ->setChangeFrequency(Url::CHANGE_FREQUENCY_YEARLY))\n            ->writeToFile($outputFile);\n    }\n}\n```\n\nAnd in my Forge deployment script, I can simply add the custom artisan command to generate a new sitemap everytime I\ndeploy:\n\n```shell\n# Other stuff...\n\nif [ -f artisan ]; then\n    $FORGE_PHP artisan migrate --force\n    $FORGE_PHP artisan app:sync-content\n    $FORGE_PHP artisan app:generate-sitemap\nfi\n```\n\nSimple!\n\n# Inertia\n\nOkay, so I know I'm somewhat dunking on JavaScript in this post, but truth be told... I still love JS. I've had jobs\nworking with each of the Big Three<sup>tm</sup> frameworks in Angular, Vue, and React. I've begrudgingly been using\nReact because I'm lazy and (what seems like) one of the few that enjoy JSX. With Inertia and React, that means I can use\nthings like [shad](https://ui.shadcn.com/) for getting that clean Tailwind look (there's also\na [Vue](https://www.shadcn-vue.com/) and [Svelte](https://www.shadcn-svelte.com/) versions I used in the previous\niterations), and\nall the neat React things that are out in the wild. If it's on the web, there's probably a React library for it.\n\nI'm a fan of [pnpm](https://pnpm.io/) as a drop in replacement for npm, and I've also decided to\nditch [eslint](https://eslint.org/) and [prettier](https://prettier.io/) for [biome](https://biomejs.dev/), another drop\nin replacement for both tools, written in Rust (like all good tooling nowadays). I've had my fair share of battles over\nthe years with both eslint and prettier, and also getting them to play nice together (shout out\nto [eslint-config-prettier](https://github.com/prettier/eslint-config-prettier)). While they're fundamentally different\nthings, i.e. formatting vs. linting, I think the argument could be made they're in the same family of code quality\ntools. Biome neatly wraps them up into a single tool that _just works_. So now when I want to lint or format my React\ncomponents, no more `.eslintrc.*` and `.prettierrc.*` files to deal with, just a single `biome.json` file:\n\n```json\n{\n    \"$schema\": \"https://biomejs.dev/schemas/1.4.1/schema.json\",\n    \"organizeImports\": {\n        \"enabled\": true\n    },\n    \"formatter\": {\n        \"indentStyle\": \"space\",\n        \"indentWidth\": 4\n    },\n    \"linter\": {\n        \"enabled\": true,\n        \"rules\": {\n            \"recommended\": true\n        }\n    }\n}\n```\n\nCoupled with a neat biome command:\n\n```shell\n# When I want to format things\n$ pnpm dlx @biomejs/biome format --write ./resources/js\n\n# or, if I want to lint\n$ pnpm dlx @biomejs/biome lint ./resources/js\n```\n\nWrapping those up in my `package.json` `scripts` looks something like:\n\n```json\n{\n    // Other stuff...\n    \"scripts\": {\n        \"dev\": \"vite\",\n        \"build\": \"tsc && vite build && vite build --ssr\",\n        \"tailwind\": \"prettier --plugin prettier-plugin-tailwindcss --write ./resources/js\",\n        \"check\": \"pnpm dlx @biomejs/biome check --apply ./resources/js\",\n        \"fmt\": \"pnpm dlx @biomejs/biome format --write ./resources/js\",\n        \"fix\": \"pnpm dlx @biomejs/biome lint --apply ./resources/js\",\n        \"lint\": \"pnpm dlx @biomejs/biome lint ./resources/js\",\n        \"ci\": \"pnpm dlx @biomejs/biome ci ./resources/js\",\n        \"prepare\": \"git config core.hookspath .githooks\",\n        \"pre-commit\": \"pnpm run tailwind && pnpm run check && pnpm run fmt\"\n    }\n}\n```\n\nNow unfortunately, I'm not _entirely_ free of prettier just yet, as there's still no support for [Tailwind class sorting\nin biome](https://github.com/biomejs/biome/discussions/164). I only use prettier to simply wrangle Tailwind classes,\nthen let biome do the rest.\n\nInertia has SSR too, which boils down to simply having to run an `artisan` command on deployment to spin up your Node.js\nserver where ever it may be and point Laravel to it. With Forge, it's _literally_ the flip of a switch.\n\nOne of the things I also needed was to display some common data on each page of my website, including on all the posts\nthemselves. In the footer, you'll see a Spotify widget that displays what I'm currently listening to and the current\nbuild commit SHA the site was deployed with. With Inertia middleware, this was a simple addon to the existing configured\nmiddleware:\n\n#### app/Http/Middleware/HandleInertiaRequests.php\n\n```php\n<?php\n\ndeclare(strict_types=1);\n\nnamespace App\\Http\\Middleware;\n\nuse App\\Contracts\\MusicTrackerContract;\nuse Illuminate\\Foundation\\Application;\nuse Illuminate\\Http\\Request;\nuse Inertia\\Middleware;\nuse Tightenco\\Ziggy\\Ziggy;\n\nfinal class HandleInertiaRequests extends Middleware\n{\n    /**\n     * The root template that is loaded on the first page visit.\n     *\n     * @var string\n     */\n    protected $rootView = 'app';\n\n    public function __construct(private readonly MusicTrackerContract $spotifyTracker)\n    {\n    }\n\n    /**\n     * Determine the current asset version.\n     */\n    public function version(Request $request): ?string\n    {\n        return parent::version($request);\n    }\n\n    /**\n     * Define the props that are shared by default.\n     *\n     * @return array<string, mixed>\n     */\n    public function share(Request $request): array\n    {\n        return [\n            ...parent::share($request),\n            'ziggy' => fn () => [\n                ...(new Ziggy)->toArray(),\n                'location' => $request->url(),\n            ],\n            // Propagate the commit information on every request\n            'commit' => config('app.commit'),\n            // Also propagate the current listening data from Spotify\n            'spotify' => $this->spotifyTracker->getNowPlaying(),\n            'laravelVersion' => Application::VERSION,\n            'phpVersion' => PHP_VERSION,\n        ];\n    }\n}\n```\n\nand in my component footer:\n\n#### resources/js/Components/SpotifyTracker.tsx\n\n```tsx\nexport default function SpotifyTracker({children}: { children: React.JSX.Element }): React.JSX.Element {\n    // Inertia has a pretty sweet hook allowing us to tap into common page properties\n    const page = usePage();\n\n    const nowPlaying = page.props.spotify as NowPlaying | undefined;\n    const currentlyPlaying = nowPlaying?.nowPlaying ?? false;\n\n    return (\n        <>\n            {currentlyPlaying && nowPlaying !== undefined && (\n                <CurrentlyPlaying nowPlaying={nowPlaying}>\n                    {children}\n                </CurrentlyPlaying>\n            )}\n            {!currentlyPlaying && (\n                <NotCurrentlyPlaying>{children}</NotCurrentlyPlaying>\n            )}\n        </>\n    );\n}\n```\n\nwith the corresponding `PageProps` in `index.d.ts` changes:\n\n```typescript\nexport type NowPlaying = {\n    nowPlaying: boolean;\n    albumImageSrc?: string;\n    artist?: string;\n    href?: string;\n    trackTitle?: string;\n};\n\nexport type Note = {\n    title: string;\n    description: string;\n};\n\nexport type PageProps<\n    T extends Record<string, unknown> = Record<string, unknown>,\n> = T & {\n    commit: string;\n    laravelVersion: string;\n    phpVersion: string;\n    spotify?: NowPlaying;\n    notes: Note[];\n};\n```\n\nNow any page returned from an Inertia rendered route has all the common data available as React props. Pretty sweet,\nhuh?\n\n## Rendering content\n\nFor displaying the content of a blog post route, Laravel's route-model binding offered everything I needed to get up and\nrunning. Simply defining a route in my `web.php` like so:\n\n```php\nRoute::get('blog/{slug}', fn (string $slug, ContentRepositoryContract $contentRepository) => Inertia::render('Blog/Post/Index', [\n    'post' => $contentRepository->getBlogPostBySlug($slug),\n]))\n    ->name('post');\n```\n\npasses everything the page needs to render to the component responsible for rending content:\n\n```typescript jsx\nimport {Badge} from \"@/Components/ui/badge\";\nimport {Button} from \"@/Components/ui/button\";\nimport MainLayout from \"@/Layouts/MainLayout\";\nimport {type Post} from \"@/models\";\nimport {Head, Link} from \"@inertiajs/react\";\nimport * as React from \"react\";\n\nexport default function BlogPost({post}: { post: Post }): React.JSX.Element {\n    const formattedDate = new Date(\n        post.published_date ?? \"\",\n    ).toLocaleDateString(\"en-us\", {\n        year: \"numeric\",\n        month: \"short\",\n        day: \"numeric\",\n    });\n\n    return (\n        <>\n            <Head title={`${post.title} | joeymckenzie.tech`}>\n                <meta name=\"keywords\" content={post.keywords}/>\n            </Head>\n\n            <MainLayout>\n                <div className=\"flex flex-col justify-center\">\n                    <article\n                        className=\"prose mx-auto w-full overflow-hidden pb-6 dark:prose-invert prose-pre:text-sm prose-img:mx-auto prose-img:rounded-md\">\n                        <h1 className=\"text-center text-2xl\">{post.title}</h1>\n                        <div className=\"flex flex-row items-center justify-center gap-x-2 text-sm tracking-tight\">\n                            <time dateTime={post.published_date}>\n                                {formattedDate}\n                            </time>\n                            <Badge>{post.category}</Badge>\n                            <p>{post.views} views</p>\n                        </div>\n                        <img\n                            alt={`${post.title} blog meme`}\n                            src={post.hero_image}\n                            height=\"400\"\n                            width=\"500\"\n                        />\n                        <div\n                            // biome-ignore lint/security/noDangerouslySetInnerHtml: controlled input\n                            dangerouslySetInnerHTML={{\n                                __html: post.parsed_content,\n                            }}\n                        />\n                    </article>\n                    <Link href={route(\"blogs\")} className=\"mx-auto max-w-md\">\n                        <Button variant=\"secondary\"> Back to blogs</Button>\n                    </Link>\n                </div>\n            </MainLayout>\n        </>\n    );\n}\n```\n\nA fairly simple component that ultimately takes the converted HTML content I've run through the nifty PHP League's\n[CommonMark](https://commonmark.thephpleague.com/) library and spit out on the other side to `dangerouslySetInnerHTML`\nwithin my React code.\n\nGathering the content is simple enough with the help of Eloquent too:\n\n#### app/Services/BlogPostRepository.php\n\n```php\n<?php\n\ndeclare(strict_types=1);\n\nnamespace App\\Services;\n\nuse App\\Contracts\\ContentRepositoryContract;\nuse App\\Models\\BlogPost;\nuse DateInterval;\nuse Illuminate\\Database\\Eloquent\\Collection;\nuse Illuminate\\Support\\Facades\\Cache;\nuse Override;\n\nfinal readonly class BlogPostRepository implements ContentRepositoryContract\n{\n    #[Override]\n    public function getBlogPostBySlug(string $slug): BlogPost\n    {\n        // We won't cache the blogs, easier to let the view counts ride\n        $post = BlogPost::select([\n            'id',\n            'slug',\n            'keywords',\n            'hero_image',\n            'published_date',\n            'category',\n            'title',\n            'views',\n            'parsed_content',\n        ])->firstWhere('slug', $slug);\n\n        if (is_null($post)) {\n            abort(404);\n        }\n\n        // While we're at it, add a view count\n        // AddView::dispatch($post);\n\n        $post->views += 1;\n        $post->save();\n\n        return $post;\n    }\n\n    #[Override]\n    public function getLatestBlogPostMetadata(): Collection\n    {\n        /** @var Collection<int, BlogPost> $posts */\n        $posts = self::getBlogPostMetadata()\n            ->sortByDesc('published_date')\n            ->take(3);\n\n        return $posts;\n    }\n\n    #[Override]\n    public function getBlogPostMetadata(): Collection\n    {\n        if (Cache::has('allPosts')) {\n            /** @var Collection<int, BlogPost> $allPosts */\n            $allPosts = Cache::get('allPosts');\n\n            return $allPosts;\n        }\n\n        /** @var Collection<int, BlogPost> $posts */\n        $posts = BlogPost::select([\n            'slug',\n            'published_date',\n            'category',\n            'description',\n            'title',\n            'views',\n        ])\n            ->orderByDesc('published_date')\n            ->get();\n\n        Cache::set('allPosts', $posts, new DateInterval('PT5M'));\n\n        return $posts;\n    }\n}\n```\n\nI'm not exactly a fan of the repository pattern on top of existing repository implementations - Eloquent is _already_ a\ngreat implementation of the repository pattern. But... I like to keep my controllers/routes thin and also wanted to add\na bit a caching here and there as the content itself won't change much from deployment to deployment.\n\nWhich brings me to my next talking point...\n\n# Deployments\n\nI'm a big fan of GitHub Actions, and while I _could_ just trigger Forge deploys based on the latest push, it's easy\nenough to set up a simple action to ping the deployment URL to tell Forge to pull in my code and deploy the latest\nversion of it to the droplet. I like to display the latest commit in the footer, so I also needed a way to propagate the\ngit commit SHA as an environment variable. Unfortunately, Forge only has the SHA available at deployment time.\n_Fortunately_, it's easy enough to work around by pulling in the latest configuration for production via the Forge CLI,\nappending the SHA as an environment variable, and simply pushing it back up to Forge before the deployment script runs.\n\nOne caveat to this process is that we want the append process to only append _if_ there's currently not a commit in the `.env` file, while replacing the existing commit key-value pair if it already exists. A quick script like the follow should get the job done:\n\n```shell\n#!/bin/bash\n\n# Check if the correct number of arguments is provided\nif [ \"$#\" -ne 2 ]; then\n  echo \"Usage: $0 <arg1> <arg2>\"\n  exit 1\nfi\n\n# Assign arguments to variables\nkey=\"$1\"\nvalue=\"$2\"\n\n# Check if the key already exists in the file\nif grep -q \"^$key=\" .env; then\n  # Replace the existing key-value pair\n  sed -i \"s/^$key=.*/$key=$value/\" .env\nelse\n  # Append the new key-value pair to the end of the file\n  echo \"$key=$value\" >> .env\nfi\n```\n\n\nWe can then update our deploy workflow action to call this script, pass the key and SHA to it, and execute directly before updating the production configuration. All-in-all, this is what my deploy action looks like:\n\n```yaml\nname: Deploy to Forge\n\non:\n    workflow_run:\n        workflows: [ 'Inertia CI' ]\n        types:\n            - completed\n\njobs:\n    build:\n        runs-on: ubuntu-latest\n        timeout-minutes: 10\n\n        name: Deploy application\n        steps:\n            - uses: actions/checkout@v3\n\n            - name: Setup PHP\n              id: setup-php\n              uses: shivammathur/setup-php@v2\n              with:\n                  php-version: '8.3'\n\n            - name: Install Forge CLI\n              run: composer global require laravel/forge-cli\n\n            - name: Authenticate with Forge\n              run: forge login --token=${{ secrets.FORGE_API_TOKEN }}\n\n            # Forge environment variables, including the current git commit hash,\n            # aren't included as runtime environment variables and only in the build script.\n            # To get the current commit propagated, pull the current production configuration,\n            # and append the current commit to the file and push it back up to Forge.\n            - name: Download current configuration\n              run: forge env:pull joeymckenzie.tech ${{ github.workspace }}/.env\n\n            - name: Add current commit and push back to forge\n              run: |\n                ./scripts/update-commit.sh FORGE_DEPLOY_COMMIT ${{ github.sha }}\n              working-directory: ${{ github.workspace }}\n\n            - name: Push environment to Forge\n              run: forge env:push joeymckenzie.tech ${{ github.workspace }}/.env\n\n            - name: Ping deploy URL\n              run: curl -l ${{ secrets.FORGE_DEPLOY_URL }}\n```\n\nSetting a few environment variables, badda bing, badda boom, and everything works.\n\n## Wrapping up\n\nAlright, I promised to keep it short.\n\nIn the end, is Laravel probably overkill for my simple little website? Absolutely.\n\nIs it fun to over-engineer such things, though? Ab-so-lutely.\n\nI'm looking forward to seeing what else I can conjure up with Laravel to give myself a reason to explore all the various\nnooks and crannies of the framework as I'm not a full-time Laravel developer (yet...). All the code that powers my blog\nis available on GitHub [here](https://github.com/JoeyMckenzie/joeymckenzie.tech). I'm just beginning my Laravel journey\nand I'm well aware there's a _ton_ more to learn, but nonetheless, I'm quite excited to keep at it.\n\nTL;DR - Laravel is friggin' sweet.\n\nUntil next time, friends!\n",
    "html": "<p>Alright, I'm making this one short (sort of). My pre-New Year's Resolution is to write on my blog here more\nthan bi-annually. Since becoming a dad and taking up my jorts-laden mantle and becoming alarmingly interested in grass\nmowing techniques and New Balance footwear this past year, finding the time to write has come too far and between\n(betwixt?).</p>\n<p>I was recently on the hunt for something new to learn and after laughing at memes\non <a href=\"https://reddit.com/r/webdev/\">r/webdev</a> about PHP for far too long, I figured I had better at least learn a little\nPHP\nto understand the source of the meme'ery in the first place. Learning PHP ultimately brought me\nto <a href=\"https://laravel.com/\">Laravel</a>,\nand oh... my... god... do I feel betrayed by my fellow developers for dunking on PHP without telling me about the\nabundant Lambos running rampant in the Laravel ecosystem. I've been writing a bunch of Rust to keep my brain occupied\noutside my normal 8-to-5 and PHP was a breath of fresh air.</p>\n<p>If you're a full-time TypeScript/.NET'er working with a sprinkle of other languages like Go and Rust here and there like\nme, PHP might seem like an afterthought. I can confidently say that after embarking down the Laravel/PHP road, I'm more\nthan happy I did.</p>\n<p>I thought it would be fun to write a bit about the process of learning Laravel through re-writing my website from a few\ndifferent iterations of JS frameworks and give some insight from a newcomers perspective about Laravel and PHP.</p>\n<h2>Framework exhaustion</h2>\n<p>I'm a creature of habit, and one thing I've formed somewhat of a ritual around is re-writing my website, the very one\nyou happen to be reading, at least once a year. I've gone through a few iterations:</p>\n<ul>\n<li>Static site generators with Hugo and Jekyll</li>\n<li>SSR frameworks\nwith <a href=\"https://github.com/JoeyMckenzie/joeymckenzie.tech/tree/archive/blog-v1\">Next.js</a>, <a href=\"https://github.com/JoeyMckenzie/joeymckenzie.tech/tree/archive/nuxt-v2\">Nuxt.js</a>,\nand <a href=\"https://github.com/JoeyMckenzie/joeymckenzie.tech/tree/archive/svelte\">SvelteKit</a></li>\n<li>At one point, a combo of <a href=\"https://github.com/JoeyMckenzie/joeymckenzie.tech/tree/archive/astro-rust\">Astro and Rust</a>\nthat formed an interesting mix of SSG and <a href=\"https://docs.astro.build/en/concepts/islands/\">island architectures</a> for\nfetching dynamic data</li>\n</ul>\n<p>Quite frankly, I'm burnt out on JS framework madness, though to no fault of their own. There's many that are innovating\nand pushing the ecosystem forward with cool new technology that I'll get to use in production five years from now if I'm\nlucky. Each iteration I re-wrote wrangled a hodge podge of JS libraries for certain things I wanted to do, including but\nnot limited to:</p>\n<ul>\n<li>Parsing markdown\ncontent (<a href=\"https://contentlayer.dev\">contentlayer</a>, <a href=\"https://www.npmjs.com/package/gray-matter\">gray-matter</a>) and\nhighlighting code snippets (<a href=\"https://highlightjs.org/\">highlight.js</a>, <a href=\"https://shiki.matsu.io/\">shiki</a>)</li>\n<li>Storing things in a database with a bit of magic\nabstraction (<a href=\"https://prisma.io\">prisma</a>, <a href=\"https://orm.drizzle.team/\">drizzle</a>)</li>\n<li>Calling external APIs through framework semantics, which differ from framework to framework</li>\n<li>Caching content pages as I don't update them often</li>\n</ul>\n<p>And a plethora of other things. The nice thing about Laravel is that a lot of this is out-of-the-box functionality so\nI can indulge in my slice-of-the-internet playground that is my website.</p>\n<h2>Making code great again</h2>\n<p>I found that while re-building my site with Laravel, I was having fun writing code in a new way that I was missing when\nusing the JS flavor of the month framework. My .NET brain felt right at home with Laravel, all the while being able to\nmix and match frontends thanks to <a href=\"https://inertiajs.com\">Inertia.js</a> (I'm not quite ready to\nembrace <a href=\"https://livewire.laravel.com/\">Livewire</a> just yet). Anything I wanted to do, Laravel had an answer:</p>\n<ul>\n<li>Syncing content to the database on\ndeployment? <a href=\"https://laravel.com/docs/10.x/artisan#generating-commands\">Console commands</a>.</li>\n<li>Querying content? <a href=\"https://laravel.com/docs/10.x/eloquent\">Eloquent</a>.</li>\n<li>Built-in caching, an HTTP client, and just about anything you'll need for the general web</li>\n</ul>\n<p>The goal of this post will be to outline what I think makes Laravel great from the context of a PHP/Laravel outsider\neven for a small, mostly static website like mine.</p>\n<h2>DI from the start</h2>\n<p>Coming from .NET, I clutch onto my DI framework pearls tightly, rarely loosening my grip. I'll even die on the hill that\n.NET's first-party dependency injection framework (when used within it's expected confines) is one of the better DI\nframeworks out there (I've enjoyed it <em>much</em> more than Spring's DI with magical <code>@autowire</code>s on every bean).</p>\n<p>I like to <em>think</em> I'm not that much of a DI container shill after writing a few things in Rust and Go, and while they\nhave there place and time when serving a viable purpose, are nice to work with <em>when used correctly</em>. I see a lot of\n.NET in the wild attempting to bend <code>ServiceProvider</code>s to their application's will, creating a poor man's service\nlocator within a service locator (I'm guilty as charged).</p>\n<p>With Laravel, binding contracts to concretes is simple and straight forward. Coupled with route-provider binding\nbuilt-in DI, it quite literally felt like I was back at home writing a modern .NET application.</p>\n<h2>Strict linting opt-in</h2>\n<p>I'm glutton for punishment and Rust-level strict typing, so <a href=\"https://phpstan.org/\">phpstan</a> with the\nhelp <a href=\"https://github.com/larastan/larastan\">larastan</a> cranked up to the max scratched that itch. I'm currently\nin the process of trimming down the things I don't need with Laravel, which ultimately entails things\nlike removing auth-based middleware, migrations, and models since I have no intention of managing users. While max level\nphpstan requires a few tweaks to a freshly scaffolded <a href=\"https://github.com/laravel/breeze\">Laravel Breeze</a> app, once\nthose tweaks were made that mainly consisted of a few typing hints here and there, everything worked as expected.\nCoupled with <a href=\"https://github.com/emcrisostomo/fswatch\">fswatch</a>, I got the same DX as I'm used to with Rust akin to\nrunning something like <code>cargo watch -x clippy</code> with the help of <a href=\"https://crates.io/crates/cargo-watch\">cargo-watch</a>.\nBetter yet, hiding said <code>fswatch</code> command behind a <a href=\"https://github.com/casey/just\">justfile</a> made it seamless to\nintegrate phpstan continuously while I was writing code:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"shell\" data-theme=\"github-dark\"><code data-language=\"shell\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#B392F0\">default:</span><span style=\"color:#9ECBFF\"> pail</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\"># runs tail logging</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">pail:</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">    php</span><span style=\"color:#9ECBFF\"> artisan</span><span style=\"color:#9ECBFF\"> pail</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\"># syncs content to the database</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">sync:</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">    php</span><span style=\"color:#9ECBFF\"> artisan</span><span style=\"color:#9ECBFF\"> app:sync-content</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\"># continuously runs lint on file change</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">lint:</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">    fswatch</span><span style=\"color:#79B8FF\"> -o</span><span style=\"color:#9ECBFF\"> app/</span><span style=\"color:#F97583\"> |</span><span style=\"color:#B392F0\"> xargs</span><span style=\"color:#79B8FF\"> -n1</span><span style=\"color:#79B8FF\"> -I</span><span style=\"color:#E1E4E8\">{} sh -c \"composer run lint\"</span></span></code></pre></figure>\n<p>and in my terminal:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"shell\" data-theme=\"github-dark\"><code data-language=\"shell\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#B392F0\">$</span><span style=\"color:#9ECBFF\"> just</span><span style=\"color:#9ECBFF\"> lint</span><span style=\"color:#6A737D\"> # which runs `fswatch -o app/ | xargs -n1 -I{} sh -c \"composer run lint\"` by proxy</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">></span><span style=\"color:#E1E4E8\"> vendor/bin/phpstan analyse app</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#B392F0\">Note:</span><span style=\"color:#9ECBFF\"> Using</span><span style=\"color:#9ECBFF\"> configuration</span><span style=\"color:#9ECBFF\"> file</span><span style=\"color:#9ECBFF\"> /Users/jmckenzie/projects/php/joeymckenzie.tech/phpstan.neon.</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\"> 40/40</span><span style=\"color:#E1E4E8\"> [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100%</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\"> [OK] </span><span style=\"color:#B392F0\">No</span><span style=\"color:#9ECBFF\"> errors</span></span></code></pre></figure>\n<p>Beautiful! Any source code change within my <code>app/</code> directory triggered a full linting run to make sure I was holding\nmyself accountable for not letting my code go to shit (pardon my French).</p>\n<p>Side note, composer is easily up there with cargo competing for best language toolchain on the market. I mean come on\nJavaScript... why do we need four different package managers?</p>\n<h2>Content syncing</h2>\n<p>One of the things I need is the ability to continuously sync markdown content with the database I store it in, which in\nmy case is just a MySQL instance running on my droplet provisioned with the help of Laravel Forge (more on that later).\nRather than writing some one off shell script to do that, I found Laravel commands mighty useful to simply just define a\ncustom artisan command that would:</p>\n<ul>\n<li>Read my content files</li>\n<li>Parse the frontmatter on each markdown file</li>\n<li>Parse the markdown and convert it to HTML</li>\n<li>Save everything to the data to the database</li>\n</ul>\n<p>That ended up looking something like:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"php\" data-theme=\"github-dark\"><code data-language=\"php\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">&#x3C;?</span><span style=\"color:#79B8FF\">php</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">declare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">strict_types</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">namespace</span><span style=\"color:#B392F0\"> App\\Console\\Commands</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Contracts\\ContentUtilityContract</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Models\\ContentMeta</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Illuminate\\Console\\Command</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Throwable</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">final</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> SyncContent</span><span style=\"color:#F97583\"> extends</span><span style=\"color:#B392F0\"> Command</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">{</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * The name and signature of the console command.</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     *</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@var</span><span style=\"color:#F97583\"> string</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    protected</span><span style=\"color:#E1E4E8\"> $signature </span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\"> 'app:sync-content'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * The console command description.</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     *</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@var</span><span style=\"color:#F97583\"> string</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    protected</span><span style=\"color:#E1E4E8\"> $description </span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\"> 'Syncs content from markdown files into the database.'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * Execute the console command.</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     *</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@throws</span><span style=\"color:#79B8FF\"> Throwable</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> handle</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">ContentUtilityContract</span><span style=\"color:#E1E4E8\"> $contentUtility)</span><span style=\"color:#F97583\">:</span><span style=\"color:#F97583\"> void</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $files </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> $contentUtility</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">getMarkdownFilePaths</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">        collect</span><span style=\"color:#E1E4E8\">($files)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">map</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">fn</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">string</span><span style=\"color:#E1E4E8\"> $filePath) => $contentUtility</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">getParsedContent</span><span style=\"color:#E1E4E8\">($filePath))</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">each</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">fn</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#79B8FF\">ContentMeta</span><span style=\"color:#E1E4E8\"> $contentMeta) => $contentUtility</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">upsertBlogPost</span><span style=\"color:#E1E4E8\">($contentMeta));</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>Coming from .NET, I'm a self diagnosed <a href=\"https://learn.microsoft.com/en-us/dotnet/csharp/linq/\">LINQ</a> addict. Collections\nmade me feel right at home. From the above, I'm configuring a short pipeline of sorts that will do all the things I\noutlined with a little help from the DI container and the <code>ContentUtilityContract</code>:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"php\" data-theme=\"github-dark\"><code data-language=\"php\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">&#x3C;?</span><span style=\"color:#79B8FF\">php</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">declare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">strict_types</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">namespace</span><span style=\"color:#B392F0\"> App\\Contracts</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Models\\BlogPost</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Models\\ContentMeta</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> League\\CommonMark\\Exception\\CommonMarkException</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> League\\Config\\Exception\\ConfigurationExceptionInterface</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">interface</span><span style=\"color:#B392F0\"> ContentUtilityContract</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">{</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@return</span><span style=\"color:#F97583\"> string[]</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> getMarkdownFilePaths</span><span style=\"color:#E1E4E8\">()</span><span style=\"color:#F97583\">:</span><span style=\"color:#F97583\"> array</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@throws</span><span style=\"color:#79B8FF\"> ConfigurationExceptionInterface</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@throws</span><span style=\"color:#79B8FF\"> CommonMarkException</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> getParsedContent</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">string</span><span style=\"color:#E1E4E8\"> $filePath)</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> ContentMeta</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> upsertBlogPost</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">ContentMeta</span><span style=\"color:#E1E4E8\"> $contentMeta)</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> BlogPost</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>and whose implementation looks something like:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"php\" data-theme=\"github-dark\"><code data-language=\"php\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">&#x3C;?</span><span style=\"color:#79B8FF\">php</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">declare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">strict_types</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">namespace</span><span style=\"color:#B392F0\"> App\\Services</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Contracts\\ContentUtilityContract</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Models\\BlogPost</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Models\\ContentMeta</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Illuminate\\Support\\Facades\\Log</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> League\\CommonMark\\ConverterInterface</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> League\\CommonMark\\Extension\\FrontMatter\\Data\\SymfonyYamlFrontMatterParser</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> League\\CommonMark\\Extension\\FrontMatter\\FrontMatterParser</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Override</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">final</span><span style=\"color:#F97583\"> readonly</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> MarkdownUtility</span><span style=\"color:#F97583\"> implements</span><span style=\"color:#B392F0\"> ContentUtilityContract</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">{</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    private</span><span style=\"color:#79B8FF\"> ConverterInterface</span><span style=\"color:#E1E4E8\"> $converter;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#79B8FF\"> __construct</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">ConverterInterface</span><span style=\"color:#E1E4E8\"> $converter)</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        $this</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">converter </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> $converter;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    #[</span><span style=\"color:#79B8FF\">Override</span><span style=\"color:#E1E4E8\">]</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> getMarkdownFilePaths</span><span style=\"color:#E1E4E8\">()</span><span style=\"color:#F97583\">:</span><span style=\"color:#F97583\"> array</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $basePath </span><span style=\"color:#F97583\">=</span><span style=\"color:#B392F0\"> base_path</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $contentPath </span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\"> \"</span><span style=\"color:#E1E4E8\">$basePath</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#F97583\">.</span><span style=\"color:#9ECBFF\">'/content'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        Log</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">info</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"identified content path as </span><span style=\"color:#E1E4E8\">$contentPath</span><span style=\"color:#9ECBFF\">, globbing content files\"</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        /** </span><span style=\"color:#F97583\">@var</span><span style=\"color:#F97583\"> string[]</span><span style=\"color:#6A737D\"> $files */</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $files </span><span style=\"color:#F97583\">=</span><span style=\"color:#B392F0\"> app</span><span style=\"color:#E1E4E8\">()</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">environment</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">===</span><span style=\"color:#9ECBFF\"> 'local'</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            ?</span><span style=\"color:#79B8FF\"> glob</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#E1E4E8\">$contentPath</span><span style=\"color:#9ECBFF\">/**/*.md\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">GLOB_BRACE</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            :</span><span style=\"color:#79B8FF\"> glob</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#E1E4E8\">$contentPath</span><span style=\"color:#9ECBFF\">/*[!draft]/*.md\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">GLOB_BRACE</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $fileCount </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> count</span><span style=\"color:#E1E4E8\">($files);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        Log</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">info</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#E1E4E8\">$fileCount</span><span style=\"color:#9ECBFF\"> globbed files found\"</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">        return</span><span style=\"color:#E1E4E8\"> $files;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    #[</span><span style=\"color:#79B8FF\">Override</span><span style=\"color:#E1E4E8\">]</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> getParsedContent</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">string</span><span style=\"color:#E1E4E8\"> $filePath)</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> ContentMeta</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        Log</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">info</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"parsing content for file </span><span style=\"color:#E1E4E8\">$filePath</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        /** </span><span style=\"color:#F97583\">@var</span><span style=\"color:#F97583\"> string</span><span style=\"color:#6A737D\"> $contents */</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $contents </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> file_get_contents</span><span style=\"color:#E1E4E8\">($filePath);</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $fileInfo </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> pathinfo</span><span style=\"color:#E1E4E8\">($filePath);</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $extension </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> empty</span><span style=\"color:#E1E4E8\">($fileInfo[</span><span style=\"color:#9ECBFF\">'extension'</span><span style=\"color:#E1E4E8\">])</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            ?</span><span style=\"color:#9ECBFF\"> ''</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            :</span><span style=\"color:#9ECBFF\"> '.'</span><span style=\"color:#F97583\">.</span><span style=\"color:#E1E4E8\">$fileInfo[</span><span style=\"color:#9ECBFF\">'extension'</span><span style=\"color:#E1E4E8\">];</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $fileSlug </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> basename</span><span style=\"color:#E1E4E8\">($filePath, $extension);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        Log</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">info</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"file parsed, determined slug as </span><span style=\"color:#E1E4E8\">$fileSlug</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $frontMatterParser </span><span style=\"color:#F97583\">=</span><span style=\"color:#F97583\"> new</span><span style=\"color:#79B8FF\"> FrontMatterParser</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">new</span><span style=\"color:#79B8FF\"> SymfonyYamlFrontMatterParser</span><span style=\"color:#E1E4E8\">());</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $parsedContent </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> $frontMatterParser</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">parse</span><span style=\"color:#E1E4E8\">($contents);</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $frontMatter </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> $parsedContent</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">getFrontMatter</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $markdown </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> $parsedContent</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">getContent</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $html </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> $this</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">converter</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">convert</span><span style=\"color:#E1E4E8\">($markdown)</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">getContent</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        Log</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">info</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'frontmatter and content parsed'</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">        return</span><span style=\"color:#F97583\"> new</span><span style=\"color:#79B8FF\"> ContentMeta</span><span style=\"color:#E1E4E8\">($fileSlug, $markdown, $html, $frontMatter);</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    #[</span><span style=\"color:#79B8FF\">Override</span><span style=\"color:#E1E4E8\">]</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> upsertBlogPost</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">ContentMeta</span><span style=\"color:#E1E4E8\"> $contentMeta)</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> BlogPost</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $contentSlug </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> $contentMeta</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">slug;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        Log</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">info</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"upserting blog post </span><span style=\"color:#E1E4E8\">$contentSlug</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $upsertedBlog </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> BlogPost</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">updateOrCreate</span><span style=\"color:#E1E4E8\">([</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'slug'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentSlug,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        ], [</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'slug'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentSlug,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'title'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentMeta</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">frontMatter</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">title,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'description'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentMeta</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">frontMatter</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">description,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'category'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentMeta</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">frontMatter</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">category,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'published_date'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentMeta</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">frontMatter</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">pubDate,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'hero_image'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentMeta</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">frontMatter</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">heroImage,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'keywords'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#79B8FF\"> implode</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">','</span><span style=\"color:#E1E4E8\">, $contentMeta</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">frontMatter</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">keywords),</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'raw_content'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentMeta</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">markdown,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'parsed_content'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentMeta</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">html,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        ]);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        Log</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">info</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'blog content updated!'</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">        return</span><span style=\"color:#E1E4E8\"> $upsertedBlog;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>Now from what I've gathered... folks in the PHP community don't exactly <em>love</em> <code>final</code> classes - I have no intention on\ninheriting from these classes and like to follow a composition approach as often as possible (though not always).</p>\n<p>Now anytime I want to sync my content, a simple</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"shell\" data-theme=\"github-dark\"><code data-language=\"shell\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#B392F0\">$</span><span style=\"color:#9ECBFF\"> artisan</span><span style=\"color:#9ECBFF\"> app:sync-content</span></span></code></pre></figure>\n<p>does the trick! Note: I'm a lazy developer, so my <code>~/.zshrc</code> configuration has an alias:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"shell\" data-theme=\"github-dark\"><code data-language=\"shell\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">alias</span><span style=\"color:#E1E4E8\"> artisan</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"php artisan\"</span></span></code></pre></figure>\n<p>I could probably be even lazier and shorten it, but that'll do for now.</p>\n<h2>Servers</h2>\n<p>Using <a href=\"https://forge.laravel.com/\">Laravel Forge</a> and a DigitalOcean droplet, I'm able to turn the server provisioning\npart of my brain completely off and simply write code, commit, and push. Forge does just about everything for you when\ndeploying application servers, including setting up MySQL, PHP versions, server tooling, SSL, etc. I was even able to\ntweak the deployment script, so I could refresh/sync my markdown content with the database anytime a new deployment was\ntriggered. You're probably thinking \"wait... why do you have a database in the first place?\" There's a few reasons for\nthat.</p>\n<p>I use <a href=\"https://torchlight.dev/\">torchlight</a> for syntax highlighting in content, and storing the parsed content in the\ndatabase means I only need to pay the price of content highlighting once at deployment time. I also like to keep track\nof views on each blog, so I need some form of persistent storage. I <em>also</em> like to keep my notes in there (one of my few\npieces of website flair) where I can simply SSH to my droplet and <em>drop</em> (no pun intended) into\na <a href=\"https://laravel.com/docs/10.x/artisan#tinker\">tinker</a> session to create more notes, so something like this just works\nwhen I\nwant to add a new note without a GUI component:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"shell\" data-theme=\"github-dark\"><code data-language=\"shell\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#6A737D\"># On the droplet...</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#B392F0\">root@website</span><span style=\"color:#9ECBFF\"> /home/forge/joeymckenzie.tech</span><span style=\"color:#E1E4E8\"> $ </span><span style=\"color:#9ECBFF\">php</span><span style=\"color:#9ECBFF\"> artisan</span><span style=\"color:#9ECBFF\"> tinker</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#B392F0\">Psy</span><span style=\"color:#9ECBFF\"> Shell</span><span style=\"color:#9ECBFF\"> v0.11.22</span><span style=\"color:#E1E4E8\"> (PHP </span><span style=\"color:#79B8FF\">8.3</span><span style=\"color:#9ECBFF\">.0</span><span style=\"color:#9ECBFF\"> —</span><span style=\"color:#9ECBFF\"> cli</span><span style=\"color:#E1E4E8\">) by Justin Hileman</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">></span><span style=\"color:#79B8FF\"> \\A</span><span style=\"color:#E1E4E8\">pp</span><span style=\"color:#79B8FF\">\\M</span><span style=\"color:#E1E4E8\">odels</span><span style=\"color:#79B8FF\">\\N</span><span style=\"color:#E1E4E8\">ote::create([</span><span style=\"color:#9ECBFF\">'title'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#9ECBFF\"> 'Networking'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'description'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#9ECBFF\"> 'I have no clue how SSL truly works.'</span><span style=\"color:#E1E4E8\">]);</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">= </span><span style=\"color:#9ECBFF\">App</span><span style=\"color:#79B8FF\">\\M</span><span style=\"color:#9ECBFF\">odels</span><span style=\"color:#79B8FF\">\\N</span><span style=\"color:#9ECBFF\">ote</span><span style=\"color:#9ECBFF\"> {#7285</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">    title:</span><span style=\"color:#9ECBFF\"> \"Networking\",</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">    description:</span><span style=\"color:#9ECBFF\"> \"I have no clue how SSL truly works.\",</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">    +updated_at:</span><span style=\"color:#9ECBFF\"> \"2023-12-11 23:04:02\",</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">    +created_at:</span><span style=\"color:#9ECBFF\"> \"2023-12-11 23:04:02\",</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">    +id:</span><span style=\"color:#79B8FF\"> 5</span><span style=\"color:#9ECBFF\">,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">  }</span></span></code></pre></figure>\n<p>I can also generate sitemaps on startup too which is \"dumb easy\" (as the kids say) with the help of\nSpatie's <a href=\"https://github.com/spatie/laravel-sitemap\">Laravel sitemap library</a> paired with another console command:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"php\" data-theme=\"github-dark\"><code data-language=\"php\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">&#x3C;?</span><span style=\"color:#79B8FF\">php</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">declare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">strict_types</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">namespace</span><span style=\"color:#B392F0\"> App\\Console\\Commands</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Models\\BlogPost</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Illuminate\\Console\\Command</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Spatie\\Sitemap\\SitemapGenerator</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Spatie\\Sitemap\\Tags\\Url</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">class</span><span style=\"color:#B392F0\"> GenerateSitemap</span><span style=\"color:#F97583\"> extends</span><span style=\"color:#B392F0\"> Command</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">{</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * The name and signature of the console command.</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     *</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@var</span><span style=\"color:#F97583\"> string</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    protected</span><span style=\"color:#E1E4E8\"> $signature </span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\"> 'app:generate-sitemap'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * The console command description.</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     *</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@var</span><span style=\"color:#F97583\"> string</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    protected</span><span style=\"color:#E1E4E8\"> $description </span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\"> 'Generates the sitemap.'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * Generates a sitemap for all the SEO goodness</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> handle</span><span style=\"color:#E1E4E8\">()</span><span style=\"color:#F97583\">:</span><span style=\"color:#F97583\"> void</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        /** </span><span style=\"color:#F97583\">@var</span><span style=\"color:#F97583\"> string</span><span style=\"color:#6A737D\"> $url */</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $url </span><span style=\"color:#F97583\">=</span><span style=\"color:#B392F0\"> config</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'app.url'</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        // Build the sitemap key that will ultimately live in the public directory</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $publicPath </span><span style=\"color:#F97583\">=</span><span style=\"color:#B392F0\"> public_path</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $outputFile </span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\"> \"</span><span style=\"color:#E1E4E8\">$publicPath</span><span style=\"color:#9ECBFF\">/sitemap-index.xml\"</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        // Grab a list of the slugs from the database so we can</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        // dynamically generate the different entries of the map</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $slugs </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> BlogPost</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">select</span><span style=\"color:#E1E4E8\">([</span><span style=\"color:#9ECBFF\">'slug'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'updated_at'</span><span style=\"color:#E1E4E8\">])</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">get</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $siteMap </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> SitemapGenerator</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">create</span><span style=\"color:#E1E4E8\">($url)</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">getSitemap</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        // Roll through each entry, mapping each to a sitemap entry with a low priority change value</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">        collect</span><span style=\"color:#E1E4E8\">($slugs)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">each</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">function</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#79B8FF\">BlogPost</span><span style=\"color:#E1E4E8\"> $blogPost) </span><span style=\"color:#F97583\">use</span><span style=\"color:#E1E4E8\"> ($siteMap) {</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                $slug </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> $blogPost</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">slug;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                $siteMap</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                    -></span><span style=\"color:#B392F0\">add</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">Url</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">create</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"/blog/</span><span style=\"color:#E1E4E8\">$slug</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        -></span><span style=\"color:#B392F0\">setPriority</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        -></span><span style=\"color:#B392F0\">setChangeFrequency</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">Url</span><span style=\"color:#F97583\">::</span><span style=\"color:#79B8FF\">CHANGE_FREQUENCY_YEARLY</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        -></span><span style=\"color:#B392F0\">setLastModificationDate</span><span style=\"color:#E1E4E8\">($blogPost</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">updated_at</span><span style=\"color:#F97583\">?-></span><span style=\"color:#B392F0\">toDate</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">??</span><span style=\"color:#B392F0\"> now</span><span style=\"color:#E1E4E8\">()));</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            });</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        // Finally, add the static pages as well</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $siteMap</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">add</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">Url</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">create</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'/about'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                -></span><span style=\"color:#B392F0\">setPriority</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                -></span><span style=\"color:#B392F0\">setChangeFrequency</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">Url</span><span style=\"color:#F97583\">::</span><span style=\"color:#79B8FF\">CHANGE_FREQUENCY_YEARLY</span><span style=\"color:#E1E4E8\">))</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">add</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">Url</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">create</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'/now'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                -></span><span style=\"color:#B392F0\">setPriority</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                -></span><span style=\"color:#B392F0\">setChangeFrequency</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">Url</span><span style=\"color:#F97583\">::</span><span style=\"color:#79B8FF\">CHANGE_FREQUENCY_YEARLY</span><span style=\"color:#E1E4E8\">))</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">writeToFile</span><span style=\"color:#E1E4E8\">($outputFile);</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>And in my Forge deployment script, I can simply add the custom artisan command to generate a new sitemap everytime I\ndeploy:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"shell\" data-theme=\"github-dark\"><code data-language=\"shell\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#6A737D\"># Other stuff...</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">if</span><span style=\"color:#E1E4E8\"> [ </span><span style=\"color:#F97583\">-f</span><span style=\"color:#E1E4E8\"> artisan ]; </span><span style=\"color:#F97583\">then</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    $FORGE_PHP </span><span style=\"color:#9ECBFF\">artisan</span><span style=\"color:#9ECBFF\"> migrate</span><span style=\"color:#79B8FF\"> --force</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    $FORGE_PHP </span><span style=\"color:#9ECBFF\">artisan</span><span style=\"color:#9ECBFF\"> app:sync-content</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    $FORGE_PHP </span><span style=\"color:#9ECBFF\">artisan</span><span style=\"color:#9ECBFF\"> app:generate-sitemap</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">fi</span></span></code></pre></figure>\n<p>Simple!</p>\n<h1>Inertia</h1>\n<p>Okay, so I know I'm somewhat dunking on JavaScript in this post, but truth be told... I still love JS. I've had jobs\nworking with each of the Big Threetm frameworks in Angular, Vue, and React. I've begrudgingly been using\nReact because I'm lazy and (what seems like) one of the few that enjoy JSX. With Inertia and React, that means I can use\nthings like <a href=\"https://ui.shadcn.com/\">shad</a> for getting that clean Tailwind look (there's also\na <a href=\"https://www.shadcn-vue.com/\">Vue</a> and <a href=\"https://www.shadcn-svelte.com/\">Svelte</a> versions I used in the previous\niterations), and\nall the neat React things that are out in the wild. If it's on the web, there's probably a React library for it.</p>\n<p>I'm a fan of <a href=\"https://pnpm.io/\">pnpm</a> as a drop in replacement for npm, and I've also decided to\nditch <a href=\"https://eslint.org/\">eslint</a> and <a href=\"https://prettier.io/\">prettier</a> for <a href=\"https://biomejs.dev/\">biome</a>, another drop\nin replacement for both tools, written in Rust (like all good tooling nowadays). I've had my fair share of battles over\nthe years with both eslint and prettier, and also getting them to play nice together (shout out\nto <a href=\"https://github.com/prettier/eslint-config-prettier\">eslint-config-prettier</a>). While they're fundamentally different\nthings, i.e. formatting vs. linting, I think the argument could be made they're in the same family of code quality\ntools. Biome neatly wraps them up into a single tool that <em>just works</em>. So now when I want to lint or format my React\ncomponents, no more <code>.eslintrc.*</code> and <code>.prettierrc.*</code> files to deal with, just a single <code>biome.json</code> file:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"json\" data-theme=\"github-dark\"><code data-language=\"json\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#E1E4E8\">{</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">    \"$schema\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"https://biomejs.dev/schemas/1.4.1/schema.json\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">    \"organizeImports\"</span><span style=\"color:#E1E4E8\">: {</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"enabled\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#79B8FF\">true</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    },</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">    \"formatter\"</span><span style=\"color:#E1E4E8\">: {</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"indentStyle\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"space\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"indentWidth\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#79B8FF\">4</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    },</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">    \"linter\"</span><span style=\"color:#E1E4E8\">: {</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"enabled\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#79B8FF\">true</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"rules\"</span><span style=\"color:#E1E4E8\">: {</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">            \"recommended\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#79B8FF\">true</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        }</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>Coupled with a neat biome command:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"shell\" data-theme=\"github-dark\"><code data-language=\"shell\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#6A737D\"># When I want to format things</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">$</span><span style=\"color:#9ECBFF\"> pnpm</span><span style=\"color:#9ECBFF\"> dlx</span><span style=\"color:#9ECBFF\"> @biomejs/biome</span><span style=\"color:#9ECBFF\"> format</span><span style=\"color:#79B8FF\"> --write</span><span style=\"color:#9ECBFF\"> ./resources/js</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\"># or, if I want to lint</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">$</span><span style=\"color:#9ECBFF\"> pnpm</span><span style=\"color:#9ECBFF\"> dlx</span><span style=\"color:#9ECBFF\"> @biomejs/biome</span><span style=\"color:#9ECBFF\"> lint</span><span style=\"color:#9ECBFF\"> ./resources/js</span></span></code></pre></figure>\n<p>Wrapping those up in my <code>package.json</code> <code>scripts</code> looks something like:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"json\" data-theme=\"github-dark\"><code data-language=\"json\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#E1E4E8\">{</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    // Other stuff...</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">    \"scripts\"</span><span style=\"color:#E1E4E8\">: {</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"dev\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"vite\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"build\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"tsc &#x26;&#x26; vite build &#x26;&#x26; vite build --ssr\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"tailwind\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"prettier --plugin prettier-plugin-tailwindcss --write ./resources/js\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"check\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"pnpm dlx @biomejs/biome check --apply ./resources/js\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"fmt\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"pnpm dlx @biomejs/biome format --write ./resources/js\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"fix\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"pnpm dlx @biomejs/biome lint --apply ./resources/js\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"lint\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"pnpm dlx @biomejs/biome lint ./resources/js\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"ci\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"pnpm dlx @biomejs/biome ci ./resources/js\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"prepare\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"git config core.hookspath .githooks\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        \"pre-commit\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">\"pnpm run tailwind &#x26;&#x26; pnpm run check &#x26;&#x26; pnpm run fmt\"</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>Now unfortunately, I'm not <em>entirely</em> free of prettier just yet, as there's still no support for <a href=\"https://github.com/biomejs/biome/discussions/164\">Tailwind class sorting\nin biome</a>. I only use prettier to simply wrangle Tailwind classes,\nthen let biome do the rest.</p>\n<p>Inertia has SSR too, which boils down to simply having to run an <code>artisan</code> command on deployment to spin up your Node.js\nserver where ever it may be and point Laravel to it. With Forge, it's <em>literally</em> the flip of a switch.</p>\n<p>One of the things I also needed was to display some common data on each page of my website, including on all the posts\nthemselves. In the footer, you'll see a Spotify widget that displays what I'm currently listening to and the current\nbuild commit SHA the site was deployed with. With Inertia middleware, this was a simple addon to the existing configured\nmiddleware:</p>\n<h4>app/Http/Middleware/HandleInertiaRequests.php</h4>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"php\" data-theme=\"github-dark\"><code data-language=\"php\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">&#x3C;?</span><span style=\"color:#79B8FF\">php</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">declare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">strict_types</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">namespace</span><span style=\"color:#B392F0\"> App\\Http\\Middleware</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Contracts\\MusicTrackerContract</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Illuminate\\Foundation\\Application</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Illuminate\\Http\\Request</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Inertia\\Middleware</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Tightenco\\Ziggy\\Ziggy</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">final</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> HandleInertiaRequests</span><span style=\"color:#F97583\"> extends</span><span style=\"color:#B392F0\"> Middleware</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">{</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * The root template that is loaded on the first page visit.</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     *</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@var</span><span style=\"color:#F97583\"> string</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    protected</span><span style=\"color:#E1E4E8\"> $rootView </span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\"> 'app'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#79B8FF\"> __construct</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">private</span><span style=\"color:#F97583\"> readonly</span><span style=\"color:#79B8FF\"> MusicTrackerContract</span><span style=\"color:#E1E4E8\"> $spotifyTracker)</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * Determine the current asset version.</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> version</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">Request</span><span style=\"color:#E1E4E8\"> $request)</span><span style=\"color:#F97583\">:</span><span style=\"color:#F97583\"> ?string</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">        return</span><span style=\"color:#F97583\"> parent::</span><span style=\"color:#B392F0\">version</span><span style=\"color:#E1E4E8\">($request);</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    /**</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * Define the props that are shared by default.</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     *</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     * </span><span style=\"color:#F97583\">@return</span><span style=\"color:#F97583\"> array</span><span style=\"color:#6A737D\">&#x3C;</span><span style=\"color:#F97583\">string</span><span style=\"color:#6A737D\">, mixed></span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">     */</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> share</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">Request</span><span style=\"color:#E1E4E8\"> $request)</span><span style=\"color:#F97583\">:</span><span style=\"color:#F97583\"> array</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">        return</span><span style=\"color:#E1E4E8\"> [</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            ...parent::</span><span style=\"color:#B392F0\">share</span><span style=\"color:#E1E4E8\">($request),</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'ziggy'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#F97583\"> fn</span><span style=\"color:#E1E4E8\"> () => [</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                ...</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">new</span><span style=\"color:#79B8FF\"> Ziggy</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">toArray</span><span style=\"color:#E1E4E8\">(),</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">                'location'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $request</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">url</span><span style=\"color:#E1E4E8\">(),</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            ],</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">            // Propagate the commit information on every request</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'commit'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#B392F0\"> config</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'app.commit'</span><span style=\"color:#E1E4E8\">),</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">            // Also propagate the current listening data from Spotify</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'spotify'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#79B8FF\"> $this</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">spotifyTracker</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">getNowPlaying</span><span style=\"color:#E1E4E8\">(),</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'laravelVersion'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#79B8FF\"> Application</span><span style=\"color:#F97583\">::</span><span style=\"color:#79B8FF\">VERSION</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'phpVersion'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#79B8FF\"> PHP_VERSION</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        ];</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>and in my component footer:</p>\n<h4>resources/js/Components/SpotifyTracker.tsx</h4>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"tsx\" data-theme=\"github-dark\"><code data-language=\"tsx\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> default</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> SpotifyTracker</span><span style=\"color:#E1E4E8\">({</span><span style=\"color:#FFAB70\">children</span><span style=\"color:#E1E4E8\">}</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">children</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> React</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">JSX</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">Element</span><span style=\"color:#E1E4E8\"> })</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> React</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">JSX</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">Element</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">    // Inertia has a pretty sweet hook allowing us to tap into common page properties</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    const</span><span style=\"color:#79B8FF\"> page</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> usePage</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">    const</span><span style=\"color:#79B8FF\"> nowPlaying</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> page.props.spotify </span><span style=\"color:#F97583\">as</span><span style=\"color:#B392F0\"> NowPlaying</span><span style=\"color:#F97583\"> |</span><span style=\"color:#79B8FF\"> undefined</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    const</span><span style=\"color:#79B8FF\"> currentlyPlaying</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> nowPlaying?.nowPlaying </span><span style=\"color:#F97583\">??</span><span style=\"color:#79B8FF\"> false</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> (</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        &#x3C;></span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            {currentlyPlaying </span><span style=\"color:#F97583\">&#x26;&#x26;</span><span style=\"color:#E1E4E8\"> nowPlaying </span><span style=\"color:#F97583\">!==</span><span style=\"color:#79B8FF\"> undefined</span><span style=\"color:#F97583\"> &#x26;&#x26;</span><span style=\"color:#E1E4E8\"> (</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                &#x3C;</span><span style=\"color:#79B8FF\">CurrentlyPlaying</span><span style=\"color:#B392F0\"> nowPlaying</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">{nowPlaying}></span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                    {children}</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                &#x3C;/</span><span style=\"color:#79B8FF\">CurrentlyPlaying</span><span style=\"color:#E1E4E8\">></span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            )}</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            {</span><span style=\"color:#F97583\">!</span><span style=\"color:#E1E4E8\">currentlyPlaying </span><span style=\"color:#F97583\">&#x26;&#x26;</span><span style=\"color:#E1E4E8\"> (</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                &#x3C;</span><span style=\"color:#79B8FF\">NotCurrentlyPlaying</span><span style=\"color:#E1E4E8\">>{children}&#x3C;/</span><span style=\"color:#79B8FF\">NotCurrentlyPlaying</span><span style=\"color:#E1E4E8\">></span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            )}</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        &#x3C;/></span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    );</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>with the corresponding <code>PageProps</code> in <code>index.d.ts</code> changes:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"typescript\" data-theme=\"github-dark\"><code data-language=\"typescript\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> type</span><span style=\"color:#B392F0\"> NowPlaying</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    nowPlaying</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> boolean</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    albumImageSrc</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    artist</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    href</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    trackTitle</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">};</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> type</span><span style=\"color:#B392F0\"> Note</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    title</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    description</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">};</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> type</span><span style=\"color:#B392F0\"> PageProps</span><span style=\"color:#E1E4E8\">&#x3C;</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">    T</span><span style=\"color:#F97583\"> extends</span><span style=\"color:#B392F0\"> Record</span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#79B8FF\">string</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">unknown</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#B392F0\"> Record</span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#79B8FF\">string</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">unknown</span><span style=\"color:#E1E4E8\">>,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#B392F0\"> T</span><span style=\"color:#F97583\"> &#x26;</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    commit</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    laravelVersion</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    phpVersion</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    spotify</span><span style=\"color:#F97583\">?:</span><span style=\"color:#B392F0\"> NowPlaying</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#FFAB70\">    notes</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> Note</span><span style=\"color:#E1E4E8\">[];</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">};</span></span></code></pre></figure>\n<p>Now any page returned from an Inertia rendered route has all the common data available as React props. Pretty sweet,\nhuh?</p>\n<h2>Rendering content</h2>\n<p>For displaying the content of a blog post route, Laravel's route-model binding offered everything I needed to get up and\nrunning. Simply defining a route in my <code>web.php</code> like so:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"php\" data-theme=\"github-dark\"><code data-language=\"php\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#79B8FF\">Route</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">get</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'blog/{slug}'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#F97583\">fn</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">string</span><span style=\"color:#E1E4E8\"> $slug, </span><span style=\"color:#79B8FF\">ContentRepositoryContract</span><span style=\"color:#E1E4E8\"> $contentRepository) => </span><span style=\"color:#79B8FF\">Inertia</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">render</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'Blog/Post/Index'</span><span style=\"color:#E1E4E8\">, [</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">    'post'</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> $contentRepository</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">getBlogPostBySlug</span><span style=\"color:#E1E4E8\">($slug),</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">]))</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    -></span><span style=\"color:#B392F0\">name</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'post'</span><span style=\"color:#E1E4E8\">);</span></span></code></pre></figure>\n<p>passes everything the page needs to render to the component responsible for rending content:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"typescript\" data-theme=\"github-dark\"><code data-language=\"typescript\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> {Badge} </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> \"@/Components/ui/badge\"</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> {Button} </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> \"@/Components/ui/button\"</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> MainLayout </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> \"@/Layouts/MainLayout\"</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> {</span><span style=\"color:#F97583\">type</span><span style=\"color:#E1E4E8\"> Post} </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> \"@/models\"</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> {Head, Link} </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> \"@inertiajs/react\"</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">import</span><span style=\"color:#79B8FF\"> *</span><span style=\"color:#F97583\"> as</span><span style=\"color:#E1E4E8\"> React </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> \"react\"</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> default</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> BlogPost</span><span style=\"color:#E1E4E8\">({</span><span style=\"color:#FFAB70\">post</span><span style=\"color:#E1E4E8\">}</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">post</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> Post</span><span style=\"color:#E1E4E8\"> })</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> React</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">JSX</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">Element</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    const</span><span style=\"color:#79B8FF\"> formattedDate</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> new</span><span style=\"color:#B392F0\"> Date</span><span style=\"color:#E1E4E8\">(</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        post.published_date </span><span style=\"color:#F97583\">??</span><span style=\"color:#9ECBFF\"> \"\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    ).</span><span style=\"color:#B392F0\">toLocaleDateString</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"en-us\"</span><span style=\"color:#E1E4E8\">, {</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        year: </span><span style=\"color:#9ECBFF\">\"numeric\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        month: </span><span style=\"color:#9ECBFF\">\"short\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        day: </span><span style=\"color:#9ECBFF\">\"numeric\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    });</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> (</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">        &#x3C;></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            &#x3C;</span><span style=\"color:#E1E4E8\">Head title</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">{</span><span style=\"color:#9ECBFF\">`${</span><span style=\"color:#E1E4E8\">post</span><span style=\"color:#9ECBFF\">.</span><span style=\"color:#E1E4E8\">title</span><span style=\"color:#9ECBFF\">} | joeymckenzie.tech`</span><span style=\"color:#E1E4E8\">}</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                &#x3C;</span><span style=\"color:#E1E4E8\">meta name</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"keywords\"</span><span style=\"color:#E1E4E8\"> content</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">{post.keywords}</span><span style=\"color:#F97583\">/></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            &#x3C;/</span><span style=\"color:#E1E4E8\">Head</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            &#x3C;</span><span style=\"color:#B392F0\">MainLayout</span><span style=\"color:#E1E4E8\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                &#x3C;</span><span style=\"color:#E1E4E8\">div className</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"flex flex-col justify-center\"</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                    &#x3C;</span><span style=\"color:#FFAB70\">article</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                        className</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"prose mx-auto w-full overflow-hidden pb-6 dark:prose-invert prose-pre:text-sm prose-img:mx-auto prose-img:rounded-md\"</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        &#x3C;</span><span style=\"color:#E1E4E8\">h1 className</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"text-center text-2xl\"</span><span style=\"color:#F97583\">></span><span style=\"color:#E1E4E8\">{post.title}</span><span style=\"color:#F97583\">&#x3C;/</span><span style=\"color:#E1E4E8\">h1</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        &#x3C;</span><span style=\"color:#E1E4E8\">div className</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"flex flex-row items-center justify-center gap-x-2 text-sm tracking-tight\"</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                            &#x3C;</span><span style=\"color:#E1E4E8\">time dateTime</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">{post.published_date}</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                                {</span><span style=\"color:#FFAB70\">formattedDate</span><span style=\"color:#E1E4E8\">}</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                            &#x3C;/</span><span style=\"color:#E1E4E8\">time</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                            &#x3C;</span><span style=\"color:#B392F0\">Badge</span><span style=\"color:#E1E4E8\">>{post.category}</span><span style=\"color:#F97583\">&#x3C;/</span><span style=\"color:#E1E4E8\">Badge</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                            &#x3C;</span><span style=\"color:#B392F0\">p</span><span style=\"color:#E1E4E8\">>{post.views} views</span><span style=\"color:#F97583\">&#x3C;/</span><span style=\"color:#E1E4E8\">p</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        &#x3C;/</span><span style=\"color:#E1E4E8\">div</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        &#x3C;</span><span style=\"color:#FFAB70\">img</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                            alt</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">{</span><span style=\"color:#9ECBFF\">`${</span><span style=\"color:#E1E4E8\">post</span><span style=\"color:#9ECBFF\">.</span><span style=\"color:#E1E4E8\">title</span><span style=\"color:#9ECBFF\">} blog meme`</span><span style=\"color:#E1E4E8\">}</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                            src</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">{post.hero_image}</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                            height</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"400\"</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                            width</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"500\"</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        /></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        &#x3C;</span><span style=\"color:#FFAB70\">div</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">                            // biome-ignore lint/security/noDangerouslySetInnerHtml: controlled input</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                            dangerouslySetInnerHTML</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">{{</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">                                __html</span><span style=\"color:#E1E4E8\">: post.parsed_content,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">                            }}</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        /></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                    &#x3C;/</span><span style=\"color:#E1E4E8\">article</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                    &#x3C;</span><span style=\"color:#E1E4E8\">Link href</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">{</span><span style=\"color:#B392F0\">route</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"blogs\"</span><span style=\"color:#E1E4E8\">)} className</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"mx-auto max-w-md\"</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                        &#x3C;</span><span style=\"color:#E1E4E8\">Button variant</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"secondary\"</span><span style=\"color:#F97583\">></span><span style=\"color:#E1E4E8\"> Back to blogs</span><span style=\"color:#F97583\">&#x3C;/</span><span style=\"color:#E1E4E8\">Button</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                    &#x3C;/</span><span style=\"color:#E1E4E8\">Link</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">                &#x3C;/</span><span style=\"color:#E1E4E8\">div</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            &#x3C;/</span><span style=\"color:#E1E4E8\">MainLayout</span><span style=\"color:#F97583\">></span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">        &#x3C;/></span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    );</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>A fairly simple component that ultimately takes the converted HTML content I've run through the nifty PHP League's\n<a href=\"https://commonmark.thephpleague.com/\">CommonMark</a> library and spit out on the other side to <code>dangerouslySetInnerHTML</code>\nwithin my React code.</p>\n<p>Gathering the content is simple enough with the help of Eloquent too:</p>\n<h4>app/Services/BlogPostRepository.php</h4>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"php\" data-theme=\"github-dark\"><code data-language=\"php\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#F97583\">&#x3C;?</span><span style=\"color:#79B8FF\">php</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">declare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">strict_types</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">namespace</span><span style=\"color:#B392F0\"> App\\Services</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Contracts\\ContentRepositoryContract</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> App\\Models\\BlogPost</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> DateInterval</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Illuminate\\Database\\Eloquent\\Collection</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Illuminate\\Support\\Facades\\Cache</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">use</span><span style=\"color:#79B8FF\"> Override</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">final</span><span style=\"color:#F97583\"> readonly</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> BlogPostRepository</span><span style=\"color:#F97583\"> implements</span><span style=\"color:#B392F0\"> ContentRepositoryContract</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">{</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    #[</span><span style=\"color:#79B8FF\">Override</span><span style=\"color:#E1E4E8\">]</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> getBlogPostBySlug</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">string</span><span style=\"color:#E1E4E8\"> $slug)</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> BlogPost</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        // We won't cache the blogs, easier to let the view counts ride</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $post </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> BlogPost</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">select</span><span style=\"color:#E1E4E8\">([</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'id'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'slug'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'keywords'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'hero_image'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'published_date'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'category'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'title'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'views'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'parsed_content'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        ])</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">firstWhere</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'slug'</span><span style=\"color:#E1E4E8\">, $slug);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">        if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#79B8FF\">is_null</span><span style=\"color:#E1E4E8\">($post)) {</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">            abort</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">404</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        }</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        // While we're at it, add a view count</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        // AddView::dispatch($post);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $post</span><span style=\"color:#F97583\">-></span><span style=\"color:#E1E4E8\">views </span><span style=\"color:#F97583\">+=</span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $post</span><span style=\"color:#F97583\">-></span><span style=\"color:#B392F0\">save</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">        return</span><span style=\"color:#E1E4E8\"> $post;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    #[</span><span style=\"color:#79B8FF\">Override</span><span style=\"color:#E1E4E8\">]</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> getLatestBlogPostMetadata</span><span style=\"color:#E1E4E8\">()</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> Collection</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        /** </span><span style=\"color:#F97583\">@var</span><span style=\"color:#79B8FF\"> Collection</span><span style=\"color:#6A737D\">&#x3C;</span><span style=\"color:#F97583\">int</span><span style=\"color:#6A737D\">, BlogPost> $posts */</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $posts </span><span style=\"color:#F97583\">=</span><span style=\"color:#F97583\"> self::</span><span style=\"color:#B392F0\">getBlogPostMetadata</span><span style=\"color:#E1E4E8\">()</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">sortByDesc</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'published_date'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">take</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">3</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">        return</span><span style=\"color:#E1E4E8\"> $posts;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    #[</span><span style=\"color:#79B8FF\">Override</span><span style=\"color:#E1E4E8\">]</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">    public</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> getBlogPostMetadata</span><span style=\"color:#E1E4E8\">()</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> Collection</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    {</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">        if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#79B8FF\">Cache</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">has</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'allPosts'</span><span style=\"color:#E1E4E8\">)) {</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">            /** </span><span style=\"color:#F97583\">@var</span><span style=\"color:#79B8FF\"> Collection</span><span style=\"color:#6A737D\">&#x3C;</span><span style=\"color:#F97583\">int</span><span style=\"color:#6A737D\">, BlogPost> $allPosts */</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            $allPosts </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> Cache</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">get</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'allPosts'</span><span style=\"color:#E1E4E8\">);</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">            return</span><span style=\"color:#E1E4E8\"> $allPosts;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        }</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">        /** </span><span style=\"color:#F97583\">@var</span><span style=\"color:#79B8FF\"> Collection</span><span style=\"color:#6A737D\">&#x3C;</span><span style=\"color:#F97583\">int</span><span style=\"color:#6A737D\">, BlogPost> $posts */</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        $posts </span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\"> BlogPost</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">select</span><span style=\"color:#E1E4E8\">([</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'slug'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'published_date'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'category'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'description'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'title'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">            'views'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">        ])</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">orderByDesc</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'published_date'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">            -></span><span style=\"color:#B392F0\">get</span><span style=\"color:#E1E4E8\">();</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">        Cache</span><span style=\"color:#F97583\">::</span><span style=\"color:#B392F0\">set</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'allPosts'</span><span style=\"color:#E1E4E8\">, $posts, </span><span style=\"color:#F97583\">new</span><span style=\"color:#79B8FF\"> DateInterval</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'PT5M'</span><span style=\"color:#E1E4E8\">));</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#F97583\">        return</span><span style=\"color:#E1E4E8\"> $posts;</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">}</span></span></code></pre></figure>\n<p>I'm not exactly a fan of the repository pattern on top of existing repository implementations - Eloquent is <em>already</em> a\ngreat implementation of the repository pattern. But... I like to keep my controllers/routes thin and also wanted to add\na bit a caching here and there as the content itself won't change much from deployment to deployment.</p>\n<p>Which brings me to my next talking point...</p>\n<h1>Deployments</h1>\n<p>I'm a big fan of GitHub Actions, and while I <em>could</em> just trigger Forge deploys based on the latest push, it's easy\nenough to set up a simple action to ping the deployment URL to tell Forge to pull in my code and deploy the latest\nversion of it to the droplet. I like to display the latest commit in the footer, so I also needed a way to propagate the\ngit commit SHA as an environment variable. Unfortunately, Forge only has the SHA available at deployment time.\n<em>Fortunately</em>, it's easy enough to work around by pulling in the latest configuration for production via the Forge CLI,\nappending the SHA as an environment variable, and simply pushing it back up to Forge before the deployment script runs.</p>\n<p>One caveat to this process is that we want the append process to only append <em>if</em> there's currently not a commit in the <code>.env</code> file, while replacing the existing commit key-value pair if it already exists. A quick script like the follow should get the job done:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"shell\" data-theme=\"github-dark\"><code data-language=\"shell\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#6A737D\">#!/bin/bash</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\"># Check if the correct number of arguments is provided</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">if</span><span style=\"color:#E1E4E8\"> [ </span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#79B8FF\">$#</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#F97583\"> -ne</span><span style=\"color:#79B8FF\"> 2</span><span style=\"color:#E1E4E8\"> ]; </span><span style=\"color:#F97583\">then</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">  echo</span><span style=\"color:#9ECBFF\"> \"Usage: </span><span style=\"color:#79B8FF\">$0</span><span style=\"color:#9ECBFF\"> &#x3C;arg1> &#x3C;arg2>\"</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">  exit</span><span style=\"color:#79B8FF\"> 1</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">fi</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\"># Assign arguments to variables</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">key</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#79B8FF\">$1</span><span style=\"color:#9ECBFF\">\"</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">value</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#79B8FF\">$2</span><span style=\"color:#9ECBFF\">\"</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\"># Check if the key already exists in the file</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">if</span><span style=\"color:#B392F0\"> grep</span><span style=\"color:#79B8FF\"> -q</span><span style=\"color:#9ECBFF\"> \"^</span><span style=\"color:#E1E4E8\">$key</span><span style=\"color:#9ECBFF\">=\"</span><span style=\"color:#9ECBFF\"> .env</span><span style=\"color:#E1E4E8\">; </span><span style=\"color:#F97583\">then</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">  # Replace the existing key-value pair</span></span>\n<span data-line=\"\"><span style=\"color:#B392F0\">  sed</span><span style=\"color:#79B8FF\"> -i</span><span style=\"color:#9ECBFF\"> \"s/^</span><span style=\"color:#E1E4E8\">$key</span><span style=\"color:#9ECBFF\">=.*/</span><span style=\"color:#E1E4E8\">$key</span><span style=\"color:#9ECBFF\">=</span><span style=\"color:#E1E4E8\">$value</span><span style=\"color:#9ECBFF\">/\"</span><span style=\"color:#9ECBFF\"> .env</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">else</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">  # Append the new key-value pair to the end of the file</span></span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">  echo</span><span style=\"color:#9ECBFF\"> \"</span><span style=\"color:#E1E4E8\">$key</span><span style=\"color:#9ECBFF\">=</span><span style=\"color:#E1E4E8\">$value</span><span style=\"color:#9ECBFF\">\"</span><span style=\"color:#F97583\"> >></span><span style=\"color:#9ECBFF\"> .env</span></span>\n<span data-line=\"\"><span style=\"color:#F97583\">fi</span></span></code></pre></figure>\n<p>We can then update our deploy workflow action to call this script, pass the key and SHA to it, and execute directly before updating the production configuration. All-in-all, this is what my deploy action looks like:</p>\n<figure data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\" data-language=\"yaml\" data-theme=\"github-dark\"><code data-language=\"yaml\" data-theme=\"github-dark\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#85E89D\">name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">Deploy to Forge</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#79B8FF\">on</span><span style=\"color:#E1E4E8\">:</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">    workflow_run</span><span style=\"color:#E1E4E8\">:</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">        workflows</span><span style=\"color:#E1E4E8\">: [ </span><span style=\"color:#9ECBFF\">'Inertia CI'</span><span style=\"color:#E1E4E8\"> ]</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">        types</span><span style=\"color:#E1E4E8\">:</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            - </span><span style=\"color:#9ECBFF\">completed</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#85E89D\">jobs</span><span style=\"color:#E1E4E8\">:</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">    build</span><span style=\"color:#E1E4E8\">:</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">        runs-on</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">ubuntu-latest</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">        timeout-minutes</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#79B8FF\">10</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#85E89D\">        name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">Deploy application</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">        steps</span><span style=\"color:#E1E4E8\">:</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            - </span><span style=\"color:#85E89D\">uses</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">actions/checkout@v3</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            - </span><span style=\"color:#85E89D\">name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">Setup PHP</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              id</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">setup-php</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              uses</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">shivammathur/setup-php@v2</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              with</span><span style=\"color:#E1E4E8\">:</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">                  php-version</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">'8.3'</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            - </span><span style=\"color:#85E89D\">name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">Install Forge CLI</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              run</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">composer global require laravel/forge-cli</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            - </span><span style=\"color:#85E89D\">name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">Authenticate with Forge</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              run</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">forge login --token=${{ secrets.FORGE_API_TOKEN }}</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#6A737D\">            # Forge environment variables, including the current git commit hash,</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">            # aren't included as runtime environment variables and only in the build script.</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">            # To get the current commit propagated, pull the current production configuration,</span></span>\n<span data-line=\"\"><span style=\"color:#6A737D\">            # and append the current commit to the file and push it back up to Forge.</span></span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            - </span><span style=\"color:#85E89D\">name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">Download current configuration</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              run</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">forge env:pull joeymckenzie.tech ${{ github.workspace }}/.env</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            - </span><span style=\"color:#85E89D\">name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">Add current commit and push back to forge</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              run</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">|</span></span>\n<span data-line=\"\"><span style=\"color:#9ECBFF\">                ./scripts/update-commit.sh FORGE_DEPLOY_COMMIT ${{ github.sha }}</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              working-directory</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">${{ github.workspace }}</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            - </span><span style=\"color:#85E89D\">name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">Push environment to Forge</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              run</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">forge env:push joeymckenzie.tech ${{ github.workspace }}/.env</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#E1E4E8\">            - </span><span style=\"color:#85E89D\">name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">Ping deploy URL</span></span>\n<span data-line=\"\"><span style=\"color:#85E89D\">              run</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">curl -l ${{ secrets.FORGE_DEPLOY_URL }}</span></span></code></pre></figure>\n<p>Setting a few environment variables, badda bing, badda boom, and everything works.</p>\n<h2>Wrapping up</h2>\n<p>Alright, I promised to keep it short.</p>\n<p>In the end, is Laravel probably overkill for my simple little website? Absolutely.</p>\n<p>Is it fun to over-engineer such things, though? Ab-so-lutely.</p>\n<p>I'm looking forward to seeing what else I can conjure up with Laravel to give myself a reason to explore all the various\nnooks and crannies of the framework as I'm not a full-time Laravel developer (yet...). All the code that powers my blog\nis available on GitHub <a href=\"https://github.com/JoeyMckenzie/joeymckenzie.tech\">here</a>. I'm just beginning my Laravel journey\nand I'm well aware there's a <em>ton</em> more to learn, but nonetheless, I'm quite excited to keep at it.</p>\n<p>TL;DR - Laravel is friggin' sweet.</p>\n<p>Until next time, friends!</p>"
  },
  "_id": "2023/content-driven-websites-with-php-and-laravel.md",
  "_raw": {
    "sourceFilePath": "2023/content-driven-websites-with-php-and-laravel.md",
    "sourceFileName": "content-driven-websites-with-php-and-laravel.md",
    "sourceFileDir": "2023",
    "contentType": "markdown",
    "flattenedPath": "2023/content-driven-websites-with-php-and-laravel"
  },
  "type": "Post",
  "url": "/blog/2023/content-driven-websites-with-php-and-laravel"
}